<div class="two-column-container">
  <div content-section class="expanded">

    <div class="profile-header-container">
      <app-entity-header
        *ngIf="user"
        [label]="'New Certificate'"
        [title]="user.firstname + ' ' + user.lastname"
        [subtitle]="'Administrator'"
        [imageUrl]="user.imageUrl ?? 'defaultPic.jpg'">
      </app-entity-header>
    </div>

    <form [formGroup]="certificateForm" (ngSubmit)="createCertificate()" class="certificate-form">
      <div class="form-group">
        <label for="type">Certificate Type</label>
        <select id="type" formControlName="type">
          <option value="Root">Root</option>
          <option value="Intermediate">Intermediate</option>
          <option value="End-Entity">End-Entity</option>
        </select>
      </div>

      <ng-container *ngIf="certificateForm.get('type')?.value !== 'Root'">
        <div class="form-group">
          <label for="issuer">Issuer (Parent CA)</label>
          <select id="issuer" formControlName="issuerId">
            <option *ngFor="let cert of issuerCertificates" [value]="cert.id">
              {{ cert.commonName }} ({{ cert.type }})
            </option>
          </select>
        </div>
      </ng-container>

      <div class="form-group">
        <label for="commonName">Common Name (CN)</label>
        <input id="commonName" type="text" formControlName="commonName">
      </div>

      <div class="form-group">
        <label for="organization">Organization (O)</label>
        <input id="organization" type="text" formControlName="organization">
      </div>

      <div class="form-group">
        <label for="organizationalUnit">Organizational Unit (OU)</label>
        <input id="organizationalUnit" type="text" formControlName="organizationalUnit">
      </div>

      <div class="form-group">
        <label for="country">Country (C)</label>
        <input id="country" type="text" formControlName="country">
      </div>

      <div class="form-group">
        <label for="email">Email (E)</label>
        <input id="email" type="email" formControlName="email">
      </div>

      <div class="form-group">
        <label for="validityDays">Validity (in days)</label>
        <input id="validityDays" type="number" formControlName="validityDays">
      </div>

      <div class="form-actions">
        <button type="submit" [disabled]="certificateForm.invalid" class="submit-btn">
          Create Certificate
        </button>
      </div>
    </form>
  </div>
</div>
